{% extends "base.html.twig" %}
    {% block body %}

    <div class="">
       
        {{ form_start(form) }}

          <div class="form-group row hidden">
            <label for="{{form.id.vars.id}}" class="col-sm-2 col-form-label">id</label>
            <div class="col-sm-8">
                {{form(form.id)}}
            {{form_errors(form.id)}}
            {{form_widget(form.id, {'attr' :{'class' : 'fozzrm-control'}})}}
            </div>
        </div> 
        <input type="file" id="file" hidden>
        <div class="form-group row">
            <label for="{{form.name.vars.id}}" class="col-sm-2 col-form-label">Title</label>
            <div class="col-sm-8">
                {{form(form.name)}}
            {{form_errors(form.name)}}
            {{form_widget(form.name, {'attr' :{'class' : 'fozzrm-control'}})}}
            </div>
        </div>

        <div class="form-group row">
            <label for="{{form.sum.vars.id}}" class="col-sm-2 col-form-label">Summary</label>
            <div class="col-sm-8">
                {{form(form.sum)}}
            {{form_errors(form.sum)}}
            {{form_widget(form.sum, {'attr' :{'class' : 'form-control'}})}}
            </div>
        </div>
        
        <div class="form-group row">
            <label for="{{form.genre.vars.id}}" class="col-sm-2 col-form-label">Genre</label>
            <div class="col-sm-8">
                {{form(form.genre)}}
            {{form_errors(form.genre)}}
            {{form_widget(form.genre, {'attr' :{'class' : 'form-control'}})}}
            </div>
        </div>

    

        <div class="form-group row">
            <label for="{{form.author.vars.id}}" class="col-sm-2 col-form-label">Author</label>
            <div class="col-sm-8">
                {{form(form.author)}}
            {{form_errors(form.author)}}
            {{form_widget(form.author, {'attr' :{'class' : 'form-control'}})}}
            </div>
        </div>
        
        <div class="form-group row ">
            <label for="{{form.adddate.vars.id}}" class="col-sm-2 col-form-label hidden">Adddate</label>
            <div class="col-sm-8">
                {{form(form.adddate)}}
            {{form_errors(form.adddate)}}
            {{form_widget(form.adddate, {'attr' :{'class' : 'form-control'}})}}
            </div>
        </div>

        <div class="form-group row ">
            <label for="{{form.rate.vars.id}}" class="col-sm-2 col-form-label">rate</label>
            <div class="col-sm-8">
                {{form(form.rate)}}
            {{form_errors(form.rate)}}
            {{form_widget(form.rate, {'attr' :{'class' : 'form-control'}})}}
            </div>
        </div>

        <div class="form-group row ">
            <label for="{{form.image.vars.id}}" class="col-sm-2 col-form-label">image</label>
            <div class="col-sm-8">
                {{form(form.image)}}
            {{form_errors(form.image)}}
            {{form_widget(form.image, {'attr' :{'class' : 'form-control'}})}}
            </div>
        </div>

        <div class="form-group row ">
            <label for="imgFile" class="col-sm-2 col-form-label">image File</label>
            <div class="col-sm-8">
             <div id="loadedImage"style="width:50px;height:50px;border: 1px solid black;"></div>
                <button id="fileBtn">Upload Image</button>
            </div>
           
        </div>

        {# <div class="form-group row ">
            <label for="{{form.save.vars.id}}" class="col-sm-2 col-form-label">save</label>
            <div class="col-sm-8">
            {{form_widget(form.save, {'attr' :{'class' : 'btn btn-primary'}})}}
            </div>
        </div> #}
        <div class="right">
            {{form_widget(form.save, { 'label' : 'save'})}}
        </div>
        


       {{form_end(form)}}
       

    <div>

        
    <script type="text/javascript">
 
        // upload an image to db when clicking button, then return the object in json
        $('#fileBtn').click(function(){
            // click on on button trigger the hidden file input
            $('#file').trigger('click');
        })

        $('#file').change(function(){
            var file = $('#file').prop('files')[0];
            console.log(file);

            var data = new FormData();
            data.append('file', file);
            var url = '{{path('image_uploadFile')}}';

            $.ajax({
                url : url,
                data : data,
                type:"post",
                contentType:false,
                processData:false,
                cache:false,
                dataType:"json",
                success:function(data){
                    console.log(data);     
                    $('#loadedImage').append('<img alt="img" style="width:50px;height:50px;"src="/build/import/img/'+data['name'] +'"/>');
                    
                }
                    
                // fin success
            })// fin ajax

        })
    
        </script>
    {% endblock %}